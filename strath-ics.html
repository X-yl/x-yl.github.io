<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="refresh" content="0; url='http://code.verg.es/sharebookmarklet.html?author=%3Ca%20href%3D%22%23%22%3EAnonymous%3C%2Fa%3E&description=%3Ch1%3ESave%20strath%20timetable%20as%20an%20ics%3C%2Fh1%3E%0A%3Cp%3EHow%20to%20use%3A%3C%2Fp%3E%0A%3Col%3E%0A%3Cli%3EBookmark%20the%20link%20above%20%5E%2C%20drag%20it%20to%20your%20bookmark%20bar%20or%20copy%20address%20and%20create%20a%20new%20bookmark.%3C%2Fli%3E%0A%3Cli%3EGo%20to%20your%20%3Ca%20href%3D%22http%3A%2F%2Fcts.strath.ac.uk%2FScientia%2Flive2223sws%2Fdefault.aspx%3Fcontext%3Dprogrammesofstudy%22%3Eprogramme%20timetable%3C%2Fa%3E%0A%3Cli%3EClick%20on%20the%20bookmark%3C%2Fli%3E%0A%3Cli%3E%3F%3F%3F%3C%2Fli%3E%0A%3Cli%3EProfit%3C%2Fli%3E%0A%3C%2Fol%3E%20&title=Generate%20ICS&code=(()%20%3D%3E%20%7B%0A%0Aconst%20randomUUID%20%3D%20()%20%3D%3E%20%7B%0A%20%20%20return%20(%5B1e7%5D%2B-1e3%2B-4e3%2B-8e3%2B-1e11).replace(%2F%5B018%5D%2Fg%2C%20c%20%3D%3E%0A%20%20%20%20(c%20%5E%20crypto.getRandomValues(new%20Uint8Array(1))%5B0%5D%20%26%2015%20%3E%3E%20c%20%2F%204).toString(16)%0A%20%20)%3B%0A%7D%0Aconst%20formatDateTime%20%3D%20(dateTimeISOString)%20%3D%3E%20%7B%0A%20%20%20%20let%20newTime%20%3D%20dateTimeISOString.replaceAll(%27-%27%2C%20%27%27)%3B%0A%20%20%20%20newTime%20%3D%20newTime.replaceAll(%27%3A%27%2C%20%27%27)%3B%0A%20%20%20%20newTime%20%3D%20newTime.slice(0%2C%2015)%3B%0A%20%20%20%20return%20newTime%20%2B%20%22Z%22%3B%0A%7D%0Alet%20events%20%3D%20document.querySelectorAll(%27.object-cell-border%27)%3B%0Aevents%20%3D%20Array.from(events).map(event%20%3D%3E%20%7B%0A%09let%20tds%20%3D%20event.querySelectorAll(%27td%27)%3B%0A%20%20let%20weeksText%20%3D%20tds%5B4%5D.innerText%3B%0A%20%20let%20parts%20%3D%20weeksText.split(%27%2C%27)%3B%0A%20%20let%20weeks%20%3D%20%5B%5D%3B%0A%20%20for%20(let%20part%20of%20parts)%20%7B%0A%20%20%20%20if%20(part.includes(%27-%27))%20%7B%0A%20%20%20%20%20%20let%20start%20%3D%20parseInt(part.split(%27-%27)%5B0%5D)%3B%0A%20%20%20%20%20%20let%20end%20%3D%20parseInt(part.split(%27-%27)%5B1%5D)%3B%0A%20%20%20%20%20%20for%20(let%20i%20%3D%20start%3B%20i%20%3C%3D%20end%3B%20i%2B%2B)%20weeks.push(i)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20weeks.push(parseInt(part))%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%0A%20%20let%20day%20%3D%20event.parentElement.children%5B0%5D.innerText%3B%20%2F%2F%20works%20if%20in%20first%20row%0A%20%20let%20prevRow%20%3D%20event.parentElement.previousElementSibling%3B%0A%20%20%0A%20%20while%20(!%5B%22Mon%22%2C%20%22Tue%22%2C%20%22Wed%22%2C%20%22Thu%22%2C%20%22Fri%22%5D.includes(day))%20%7B%0A%20%20%20%20day%20%3D%20prevRow.querySelector(%27.row-label-one%27)%3B%0A%20%20%20%20if%20(day%20!%3D%20null)%20%7B%20day%20%3D%20day.innerText%20%7D%0A%20%20%20%20prevRow%20%3D%20prevRow.previousElementSibling%3B%0A%20%20%7D%0A%20%20%0A%20%20let%20siblings%20%3D%20%5B...event.parentNode.children%5D.filter(it%20%3D%3E%20it.classList.contains(%22cell-border%22)%20%7C%7C%20it.classList.contains(%22object-cell-border%22))%3B%0A%20%20let%20index%20%3D%20siblings.indexOf(event)%3B%0A%20%20let%20siblingsBefore%20%3D%20siblings.slice(0%2C%20index)%3B%0A%20%20let%20colStart%20%3D%200%3B%0A%20%20for%20(let%20sibling%20of%20siblingsBefore)%20%7B%0A%20%20%20%20colStart%20%2B%3D%20sibling.getAttribute(%22colspan%22)%20%3F%20parseInt(sibling.getAttribute(%22colspan%22))%20%3A%201%3B%0A%20%20%7D%0A%20%20%0A%20%20%0A%20%20return%20%7B%0A%20%20%20%20day%3A%20day%2C%0A%20%20%20%20start%3A%20colStart%20%2F%202%2C%0A%20%20%20%20end%3A%20(colStart%20%2B%20parseInt(event.getAttribute(%22colspan%22)))%20%2F%202%2C%0A%20%20%20%20module%3A%20tds%5B0%5D.innerText%2C%0A%20%20%20%20type%3A%20tds%5B1%5D.innerText%2C%0A%20%20%20%20location%3A%20tds%5B2%5D.innerText%2C%0A%20%20%20%20weeks%3A%20weeks%0A%20%20%7D%0A%7D)%3B%0A%0Alet%20calendar%20%3D%20%22BEGIN%3AVCALENDAR%5Cr%5CnVERSION%3A2.0%5Cr%5CnPRODID%3A-%2F%2Fhacksw%2Fhandcal%2F%2FNONSGML%20v1.0%2F%2FEN%5Cr%5Cn%22%0A%0Afor%20(let%20event%20of%20events)%20%7B%0A%20%20%20%20calendar%20%2B%3D%20%22BEGIN%3AVEVENT%5Cr%5Cn%22%3B%0A%20%20%20%20calendar%20%2B%3D%20%22UID%3A%22%20%2B%20randomUUID()%20%2B%20%22%5Cr%5Cn%22%3B%0A%20%20%20%20calendar%20%2B%3D%20%22DTSTAMP%3A%22%20%2B%20formatDateTime(new%20Date().toISOString())%20%2B%20%22%5Cr%5Cn%22%3B%0A%20%20%20%20calendar%20%2B%3D%20%22SUMMARY%3A%22%20%2B%20event.module%20%2B%20%22%3A%20%22%20%2B%20event.type%20%2B%20%22%5Cr%5Cn%22%3B%0A%20%20%20%20calendar%20%2B%3D%20%22LOCATION%3A%22%20%2B%20event.location%20%2B%20%22%5Cr%5Cn%22%3B%0A%20%20%20%20let%20date%20%3D%20new%20Date(%272022-09-20%2009%3A00%3A00%27)%3B%0A%20%20%20%20date.setTime(date.getTime()%20%2B%20(event.start)%20*%201000%20*%2060%20*%2060)%3B%20%2F%2F%20add%20start%20time%0A%20%20%20%20let%20numDayOfWeek%20%3D%20%5B%22Sun%22%2C%20%22Mon%22%2C%20%22Tue%22%2C%20%22Wed%22%2C%20%22Thu%22%2C%20%22Fri%22%2C%20%22Sat%22%5D.indexOf(event.day)%3B%0A%20%20%20%20date.setTime(date.getTime()%20%2B%20(numDayOfWeek%20-%20date.getDay())%20*%201000%20*%2060%20*%2060%20*%2024)%3B%20%2F%2F%20add%20day%20of%20week%0A%20%20%20%20calendar%20%2B%3D%20%22DTSTART%3A%22%20%2B%20formatDateTime(date.toISOString())%20%2B%20%22%5Cr%5Cn%22%3B%0A%20%20%20%20let%20dateEnd%20%3D%20new%20Date(date)%3B%0A%20%20%20%20dateEnd.setTime(dateEnd.getTime()%20%2B%20(event.end%20-%20event.start)%20*%201000%20*%2060%20*%2060)%3B%20%2F%2F%20add%20end%20time%0A%20%20%20%20calendar%20%2B%3D%20%22DTEND%3A%22%20%2B%20formatDateTime(dateEnd.toISOString())%20%2B%20%22%5Cr%5Cn%22%3B%0A%0A%20%20%20%20let%20rdates%20%3D%20%5B%5D%0A%20%20%20%20for%20(let%20week%20of%20event.weeks)%20%7B%0A%20%20%20%20%20%20%20%20let%20dateWeek%20%3D%20new%20Date(date)%3B%0A%20%20%20%20%20%20%20%20dateWeek.setDate(dateWeek.getDate()%20%2B%20(week%20-%208)%20*%207)%3B%0A%20%20%20%20%20%20%20%20rdates.push(formatDateTime(dateWeek.toISOString()))%3B%0A%20%20%20%20%7D%0A%20%20%20%20calendar%20%2B%3D%20%22RDATE%3A%22%20%2B%20rdates.join(%22%2C%22)%20%2B%20%22%5Cr%5Cn%22%3B%0A%20%20%20%20calendar%20%2B%3D%20%22END%3AVEVENT%5Cr%5Cn%22%3B%0A%7D%0A%0Acalendar%20%2B%3D%20%22END%3AVCALENDAR%5Cr%5Cn%22%3B%0Aconsole.log(calendar)%3B%0Awindow.open(%20%22data%3Atext%2Fcalendar%3Bcharset%3Dutf8%2C%22%20%2B%20escape(calendar))%3B%0A%7D)()'" />
  </head>
  <body>
      <p> Go here: <a href="http://code.verg.es/sharebookmarklet.html?author=%3Ca%20href%3D%22%23%22%3EAnonymous%3C%2Fa%3E&description=%3Ch1%3ESave%20strath%20timetable%20as%20an%20ics%3C%2Fh1%3E%0A%3Cp%3EHow%20to%20use%3A%3C%2Fp%3E%0A%3Col%3E%0A%3Cli%3EBookmark%20the%20link%20above%20%5E%2C%20drag%20it%20to%20your%20bookmark%20bar%20or%20copy%20address%20and%20create%20a%20new%20bookmark.%3C%2Fli%3E%0A%3Cli%3EGo%20to%20your%20%3Ca%20href%3D%22http%3A%2F%2Fcts.strath.ac.uk%2FScientia%2Flive2223sws%2Fdefault.aspx%3Fcontext%3Dprogrammesofstudy%22%3Eprogramme%20timetable%3C%2Fa%3E%0A%3Cli%3EClick%20on%20the%20bookmark%3C%2Fli%3E%0A%3Cli%3E%3F%3F%3F%3C%2Fli%3E%0A%3Cli%3EProfit%3C%2Fli%3E%0A%3C%2Fol%3E%20&title=Generate%20ICS&code=(()%20%3D%3E%20%7B%0A%0Aconst%20randomUUID%20%3D%20()%20%3D%3E%20%7B%0A%20%20%20return%20(%5B1e7%5D%2B-1e3%2B-4e3%2B-8e3%2B-1e11).replace(%2F%5B018%5D%2Fg%2C%20c%20%3D%3E%0A%20%20%20%20(c%20%5E%20crypto.getRandomValues(new%20Uint8Array(1))%5B0%5D%20%26%2015%20%3E%3E%20c%20%2F%204).toString(16)%0A%20%20)%3B%0A%7D%0Aconst%20formatDateTime%20%3D%20(dateTimeISOString)%20%3D%3E%20%7B%0A%20%20%20%20let%20newTime%20%3D%20dateTimeISOString.replaceAll(%27-%27%2C%20%27%27)%3B%0A%20%20%20%20newTime%20%3D%20newTime.replaceAll(%27%3A%27%2C%20%27%27)%3B%0A%20%20%20%20newTime%20%3D%20newTime.slice(0%2C%2015)%3B%0A%20%20%20%20return%20newTime%20%2B%20%22Z%22%3B%0A%7D%0Alet%20events%20%3D%20document.querySelectorAll(%27.object-cell-border%27)%3B%0Aevents%20%3D%20Array.from(events).map(event%20%3D%3E%20%7B%0A%09let%20tds%20%3D%20event.querySelectorAll(%27td%27)%3B%0A%20%20let%20weeksText%20%3D%20tds%5B4%5D.innerText%3B%0A%20%20let%20parts%20%3D%20weeksText.split(%27%2C%27)%3B%0A%20%20let%20weeks%20%3D%20%5B%5D%3B%0A%20%20for%20(let%20part%20of%20parts)%20%7B%0A%20%20%20%20if%20(part.includes(%27-%27))%20%7B%0A%20%20%20%20%20%20let%20start%20%3D%20parseInt(part.split(%27-%27)%5B0%5D)%3B%0A%20%20%20%20%20%20let%20end%20%3D%20parseInt(part.split(%27-%27)%5B1%5D)%3B%0A%20%20%20%20%20%20for%20(let%20i%20%3D%20start%3B%20i%20%3C%3D%20end%3B%20i%2B%2B)%20weeks.push(i)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20weeks.push(parseInt(part))%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%0A%20%20let%20day%20%3D%20event.parentElement.children%5B0%5D.innerText%3B%20%2F%2F%20works%20if%20in%20first%20row%0A%20%20let%20prevRow%20%3D%20event.parentElement.previousElementSibling%3B%0A%20%20%0A%20%20while%20(!%5B%22Mon%22%2C%20%22Tue%22%2C%20%22Wed%22%2C%20%22Thu%22%2C%20%22Fri%22%5D.includes(day))%20%7B%0A%20%20%20%20day%20%3D%20prevRow.querySelector(%27.row-label-one%27)%3B%0A%20%20%20%20if%20(day%20!%3D%20null)%20%7B%20day%20%3D%20day.innerText%20%7D%0A%20%20%20%20prevRow%20%3D%20prevRow.previousElementSibling%3B%0A%20%20%7D%0A%20%20%0A%20%20let%20siblings%20%3D%20%5B...event.parentNode.children%5D.filter(it%20%3D%3E%20it.classList.contains(%22cell-border%22)%20%7C%7C%20it.classList.contains(%22object-cell-border%22))%3B%0A%20%20let%20index%20%3D%20siblings.indexOf(event)%3B%0A%20%20let%20siblingsBefore%20%3D%20siblings.slice(0%2C%20index)%3B%0A%20%20let%20colStart%20%3D%200%3B%0A%20%20for%20(let%20sibling%20of%20siblingsBefore)%20%7B%0A%20%20%20%20colStart%20%2B%3D%20sibling.getAttribute(%22colspan%22)%20%3F%20parseInt(sibling.getAttribute(%22colspan%22))%20%3A%201%3B%0A%20%20%7D%0A%20%20%0A%20%20%0A%20%20return%20%7B%0A%20%20%20%20day%3A%20day%2C%0A%20%20%20%20start%3A%20colStart%20%2F%202%2C%0A%20%20%20%20end%3A%20(colStart%20%2B%20parseInt(event.getAttribute(%22colspan%22)))%20%2F%202%2C%0A%20%20%20%20module%3A%20tds%5B0%5D.innerText%2C%0A%20%20%20%20type%3A%20tds%5B1%5D.innerText%2C%0A%20%20%20%20location%3A%20tds%5B2%5D.innerText%2C%0A%20%20%20%20weeks%3A%20weeks%0A%20%20%7D%0A%7D)%3B%0A%0Alet%20calendar%20%3D%20%22BEGIN%3AVCALENDAR%5Cr%5CnVERSION%3A2.0%5Cr%5CnPRODID%3A-%2F%2Fhacksw%2Fhandcal%2F%2FNONSGML%20v1.0%2F%2FEN%5Cr%5Cn%22%0A%0Afor%20(let%20event%20of%20events)%20%7B%0A%20%20%20%20calendar%20%2B%3D%20%22BEGIN%3AVEVENT%5Cr%5Cn%22%3B%0A%20%20%20%20calendar%20%2B%3D%20%22UID%3A%22%20%2B%20randomUUID()%20%2B%20%22%5Cr%5Cn%22%3B%0A%20%20%20%20calendar%20%2B%3D%20%22DTSTAMP%3A%22%20%2B%20formatDateTime(new%20Date().toISOString())%20%2B%20%22%5Cr%5Cn%22%3B%0A%20%20%20%20calendar%20%2B%3D%20%22SUMMARY%3A%22%20%2B%20event.module%20%2B%20%22%3A%20%22%20%2B%20event.type%20%2B%20%22%5Cr%5Cn%22%3B%0A%20%20%20%20calendar%20%2B%3D%20%22LOCATION%3A%22%20%2B%20event.location%20%2B%20%22%5Cr%5Cn%22%3B%0A%20%20%20%20let%20date%20%3D%20new%20Date(%272022-09-20%2009%3A00%3A00%27)%3B%0A%20%20%20%20date.setTime(date.getTime()%20%2B%20(event.start)%20*%201000%20*%2060%20*%2060)%3B%20%2F%2F%20add%20start%20time%0A%20%20%20%20let%20numDayOfWeek%20%3D%20%5B%22Sun%22%2C%20%22Mon%22%2C%20%22Tue%22%2C%20%22Wed%22%2C%20%22Thu%22%2C%20%22Fri%22%2C%20%22Sat%22%5D.indexOf(event.day)%3B%0A%20%20%20%20date.setTime(date.getTime()%20%2B%20(numDayOfWeek%20-%20date.getDay())%20*%201000%20*%2060%20*%2060%20*%2024)%3B%20%2F%2F%20add%20day%20of%20week%0A%20%20%20%20calendar%20%2B%3D%20%22DTSTART%3A%22%20%2B%20formatDateTime(date.toISOString())%20%2B%20%22%5Cr%5Cn%22%3B%0A%20%20%20%20let%20dateEnd%20%3D%20new%20Date(date)%3B%0A%20%20%20%20dateEnd.setTime(dateEnd.getTime()%20%2B%20(event.end%20-%20event.start)%20*%201000%20*%2060%20*%2060)%3B%20%2F%2F%20add%20end%20time%0A%20%20%20%20calendar%20%2B%3D%20%22DTEND%3A%22%20%2B%20formatDateTime(dateEnd.toISOString())%20%2B%20%22%5Cr%5Cn%22%3B%0A%0A%20%20%20%20let%20rdates%20%3D%20%5B%5D%0A%20%20%20%20for%20(let%20week%20of%20event.weeks)%20%7B%0A%20%20%20%20%20%20%20%20let%20dateWeek%20%3D%20new%20Date(date)%3B%0A%20%20%20%20%20%20%20%20dateWeek.setDate(dateWeek.getDate()%20%2B%20(week%20-%208)%20*%207)%3B%0A%20%20%20%20%20%20%20%20rdates.push(formatDateTime(dateWeek.toISOString()))%3B%0A%20%20%20%20%7D%0A%20%20%20%20calendar%20%2B%3D%20%22RDATE%3A%22%20%2B%20rdates.join(%22%2C%22)%20%2B%20%22%5Cr%5Cn%22%3B%0A%20%20%20%20calendar%20%2B%3D%20%22END%3AVEVENT%5Cr%5Cn%22%3B%0A%7D%0A%0Acalendar%20%2B%3D%20%22END%3AVCALENDAR%5Cr%5Cn%22%3B%0Aconsole.log(calendar)%3B%0Awindow.open(%20%22data%3Atext%2Fcalendar%3Bcharset%3Dutf8%2C%22%20%2B%20escape(calendar))%3B%0A%7D)()">this link</a>.</p>
  </body>
</html>
